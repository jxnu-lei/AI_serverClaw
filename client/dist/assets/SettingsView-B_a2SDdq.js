import{B as e,C as t,D as n,E as r,F as i,K as a,N as o,O as s,P as c,R as l,S as u,V as d,W as f,i as p,j as m,k as h,r as g,w as _,x as v,y}from"./index-md6nwtnd.js";import{t as b}from"./_plugin-vue_export-helper-CSBScHBl.js";import{t as x}from"./api-BFhxd5g9.js";var S={class:`settings-container`},C={class:`slider-value`},w={style:{"margin-top":`16px`}},T={class:`about-content`},E=b(h({__name:`SettingsView`,setup(a){let h=d(`personal`),b=d(),E=e({username:``,email:``}),D={username:[{required:!0,message:`请输入用户名`,trigger:`blur`},{min:3,max:20,message:`用户名长度3-20个字符`,trigger:`blur`}],email:[{required:!0,message:`请输入邮箱`,trigger:`blur`},{type:`email`,message:`请输入正确的邮箱格式`,trigger:`blur`}]},O=d(),k=e({provider:`deepseek`,api_key:``,model:`deepseek-chat`,base_url:``,temperature:.7}),A=[{label:`DeepSeek`,value:`deepseek`},{label:`OpenAI`,value:`openai`},{label:`Ollama`,value:`ollama`}],j=d([]),M=u(()=>[...j.value,...A]),N=d(!1),P=d(``),F=()=>{P.value=``,N.value=!0},I=()=>{if(!P.value.trim()){p.warning(`请输入提供商名称`);return}let e=P.value.trim().toLowerCase().replace(/\s+/g,`-`);if(M.value.some(t=>t.value===e)){p.warning(`该提供商已存在`);return}j.value.push({label:P.value.trim(),value:e}),L(),k.provider=e,N.value=!1,p.success(`提供商添加成功`)},L=()=>{localStorage.setItem(`custom_providers`,JSON.stringify(j.value))},R=()=>{try{let e=localStorage.getItem(`custom_providers`);e&&(j.value=JSON.parse(e))}catch(e){console.error(`加载自定义提供商失败:`,e)}},z={provider:[{required:!0,message:`请选择AI服务提供商`,trigger:`change`}],api_key:[{required:!0,message:`请输入API Key`,trigger:`blur`}],model:[{required:!0,message:`请输入模型名称`,trigger:`blur`}]},B=d([]),V=async()=>{try{B.value=(await x.get(`/api/llm/configs`)).data||[]}catch(e){console.error(`加载模型列表失败:`,e)}},H=d(),U=e({theme:`default`,language:`zh-CN`,terminal_font_size:14,auto_save_session:!0,session_timeout:30}),W={theme:[{required:!0,message:`请选择主题`,trigger:`change`}],language:[{required:!0,message:`请选择语言`,trigger:`change`}]},G=async()=>{if(b.value)try{await b.value.validate();let e=localStorage.getItem(`user_id`);if(!e){p.error(`请先登录`);return}let t={username:E.username,email:E.email},n=await x.put(`/api/admin/users/${e}`,t);localStorage.setItem(`user_name`,n.data.username),p.success(`个人设置已保存`)}catch(e){console.error(`保存个人设置失败:`,e)}},K=async()=>{if(O.value)try{await O.value.validate();let e={provider:k.provider,model:k.model,api_key:k.api_key,base_url:k.base_url,temperature:k.temperature};await x.put(`/api/llm/config`,e),p.success(`AI设置已保存`)}catch(e){console.error(`保存AI设置失败:`,e)}},q=e=>{k.provider=e.provider||k.provider,k.model=e.model||k.model,k.api_key=e.api_key||k.api_key,k.base_url=e.base_url||k.base_url,k.temperature=e.temperature??k.temperature},J=async()=>{if(H.value)try{await H.value.validate();let e={...U};localStorage.setItem(`system_settings`,JSON.stringify(e)),p.success(`系统设置已保存`)}catch{p.error(`系统设置保存失败`)}},Y=()=>{g.alert(`当前后端未提供在线修改密码接口；如果需要，请联系管理员或使用重置流程。`,`修改密码`,{confirmButtonText:`知道了`,type:`info`})},X=async()=>{E.username=localStorage.getItem(`user_name`)||``,E.email=``;try{let e=localStorage.getItem(`system_settings`);if(e){let t=JSON.parse(e);Object.assign(U,t)}}catch{}try{let e=await x.get(`/api/auth/me`);E.username=e.data.username||E.username,E.email=e.data.email||E.email,localStorage.setItem(`user_name`,e.data.username||localStorage.getItem(`user_name`)||``)}catch{}try{let e=(await x.get(`/api/llm/config`)).data||{};k.provider=e.provider||k.provider,k.model=e.model||k.model,k.api_key=e.api_key||k.api_key,k.base_url=e.base_url||k.base_url,k.temperature=e.temperature??k.temperature}catch{console.log(`LLM配置未设置，使用默认值`)}};return m(()=>{R(),X(),V()}),(e,a)=>{let u=i(`el-input`),d=i(`el-form-item`),p=i(`el-button`),m=i(`el-form`),g=i(`el-card`),x=i(`el-tab-pane`),A=i(`el-option`),j=i(`el-select`),L=i(`el-slider`),R=i(`el-table-column`),V=i(`el-table`),X=i(`el-dialog`),Z=i(`el-input-number`),Q=i(`el-switch`),$=i(`el-divider`),ee=i(`el-tabs`);return o(),r(`div`,S,[a[32]||=t(`div`,{class:`settings-header`},[t(`h1`,null,`系统设置`)],-1),s(ee,{modelValue:h.value,"onUpdate:modelValue":a[14]||=e=>h.value=e,class:`settings-tabs`},{default:l(()=>[s(x,{label:`个人设置`,name:`personal`},{default:l(()=>[s(g,{class:`settings-card`},{default:l(()=>[s(m,{model:E,rules:D,ref_key:`personalFormRef`,ref:b,"label-width":`120px`},{default:l(()=>[s(d,{label:`用户名`,prop:`username`},{default:l(()=>[s(u,{modelValue:E.username,"onUpdate:modelValue":a[0]||=e=>E.username=e,placeholder:`请输入用户名`},null,8,[`modelValue`])]),_:1}),s(d,{label:`邮箱`,prop:`email`},{default:l(()=>[s(u,{modelValue:E.email,"onUpdate:modelValue":a[1]||=e=>E.email=e,type:`email`,placeholder:`请输入邮箱`},null,8,[`modelValue`])]),_:1}),s(d,{label:`修改密码`},{default:l(()=>[s(p,{type:`primary`,onClick:Y},{default:l(()=>[...a[15]||=[n(`修改密码`,-1)]]),_:1})]),_:1}),s(d,null,{default:l(()=>[s(p,{type:`primary`,onClick:G},{default:l(()=>[...a[16]||=[n(`保存设置`,-1)]]),_:1})]),_:1})]),_:1},8,[`model`])]),_:1})]),_:1}),s(x,{label:`AI 设置`,name:`ai`},{default:l(()=>[s(g,{class:`settings-card`},{default:l(()=>[s(m,{model:k,rules:z,ref_key:`aiFormRef`,ref:O,"label-width":`120px`},{default:l(()=>[s(d,{label:`AI 服务提供商`,prop:`provider`},{default:l(()=>[s(j,{modelValue:k.provider,"onUpdate:modelValue":a[2]||=e=>k.provider=e,placeholder:`请选择AI服务提供商`,filterable:``,"allow-create":``},{default:l(()=>[(o(!0),r(v,null,c(M.value,e=>(o(),_(A,{key:e.value,label:e.label,value:e.value},null,8,[`label`,`value`]))),128))]),_:1},8,[`modelValue`])]),_:1}),s(d,{label:`API Key`,prop:`api_key`},{default:l(()=>[s(u,{modelValue:k.api_key,"onUpdate:modelValue":a[3]||=e=>k.api_key=e,type:`password`,placeholder:`请输入API Key`,"show-password":``},null,8,[`modelValue`])]),_:1}),s(d,{label:`模型`,prop:`model`},{default:l(()=>[s(u,{modelValue:k.model,"onUpdate:modelValue":a[4]||=e=>k.model=e,placeholder:`请输入模型名称`},null,8,[`modelValue`])]),_:1}),s(d,{label:`API 基础URL`,prop:`base_url`},{default:l(()=>[s(u,{modelValue:k.base_url,"onUpdate:modelValue":a[5]||=e=>k.base_url=e,placeholder:`可选，例如: https://api.deepseek.com/v1 或 https://api.openai.com/v1`},null,8,[`modelValue`]),a[17]||=t(`div`,{style:{"font-size":`12px`,color:`#909399`,"margin-top":`5px`}},`留空将使用默认URL。格式: https://api.xxx.com/v1`,-1)]),_:1}),s(d,{label:`温度`,prop:`temperature`},{default:l(()=>[s(L,{modelValue:k.temperature,"onUpdate:modelValue":a[6]||=e=>k.temperature=e,min:0,max:1,step:.1},null,8,[`modelValue`]),t(`span`,C,f(k.temperature),1)]),_:1}),s(d,null,{default:l(()=>[s(p,{type:`primary`,onClick:K},{default:l(()=>[...a[18]||=[n(`保存设置`,-1)]]),_:1}),s(p,{type:`success`,onClick:F,style:{"margin-left":`12px`}},{default:l(()=>[...a[19]||=[n(`新增提供商`,-1)]]),_:1})]),_:1})]),_:1},8,[`model`])]),_:1}),t(`div`,w,[a[21]||=t(`h3`,null,`已保存模型`,-1),s(V,{data:B.value,style:{width:`100%`}},{default:l(()=>[s(R,{prop:`name`,label:`名称`}),s(R,{prop:`provider`,label:`提供商`}),s(R,{prop:`model`,label:`模型`}),s(R,{label:`操作`},{default:l(({row:e})=>[s(p,{size:`small`,onClick:t=>q(e)},{default:l(()=>[...a[20]||=[n(`使用`,-1)]]),_:1},8,[`onClick`])]),_:1})]),_:1},8,[`data`])]),s(X,{title:`新增 AI 服务提供商`,visible:N.value,width:`400px`},{footer:l(()=>[s(p,{onClick:a[8]||=e=>N.value=!1},{default:l(()=>[...a[22]||=[n(`取消`,-1)]]),_:1}),s(p,{type:`primary`,onClick:I},{default:l(()=>[...a[23]||=[n(`确定`,-1)]]),_:1})]),default:l(()=>[s(m,{"label-width":`100px`},{default:l(()=>[s(d,{label:`提供商名称`},{default:l(()=>[s(u,{modelValue:P.value,"onUpdate:modelValue":a[7]||=e=>P.value=e,placeholder:`请输入提供商名称（如：Anthropic）`,onKeyup:y(I,[`enter`])},null,8,[`modelValue`])]),_:1})]),_:1})]),_:1},8,[`visible`])]),_:1}),s(x,{label:`系统设置`,name:`system`},{default:l(()=>[s(g,{class:`settings-card`},{default:l(()=>[s(m,{model:U,rules:W,ref_key:`systemFormRef`,ref:H,"label-width":`120px`},{default:l(()=>[s(d,{label:`主题`,prop:`theme`},{default:l(()=>[s(j,{modelValue:U.theme,"onUpdate:modelValue":a[9]||=e=>U.theme=e,placeholder:`请选择主题`},{default:l(()=>[s(A,{label:`默认主题`,value:`default`}),s(A,{label:`暗色主题`,value:`dark`})]),_:1},8,[`modelValue`])]),_:1}),s(d,{label:`语言`,prop:`language`},{default:l(()=>[s(j,{modelValue:U.language,"onUpdate:modelValue":a[10]||=e=>U.language=e,placeholder:`请选择语言`},{default:l(()=>[s(A,{label:`简体中文`,value:`zh-CN`}),s(A,{label:`English`,value:`en-US`})]),_:1},8,[`modelValue`])]),_:1}),s(d,{label:`终端字体大小`,prop:`terminal_font_size`},{default:l(()=>[s(Z,{modelValue:U.terminal_font_size,"onUpdate:modelValue":a[11]||=e=>U.terminal_font_size=e,min:8,max:24,step:1},null,8,[`modelValue`])]),_:1}),s(d,{label:`自动保存会话`,prop:`auto_save_session`},{default:l(()=>[s(Q,{modelValue:U.auto_save_session,"onUpdate:modelValue":a[12]||=e=>U.auto_save_session=e},null,8,[`modelValue`])]),_:1}),s(d,{label:`会话超时时间`,prop:`session_timeout`},{default:l(()=>[s(Z,{modelValue:U.session_timeout,"onUpdate:modelValue":a[13]||=e=>U.session_timeout=e,min:5,max:120,step:5},null,8,[`modelValue`]),a[24]||=t(`span`,{class:`unit`},`分钟`,-1)]),_:1}),s(d,null,{default:l(()=>[s(p,{type:`primary`,onClick:J},{default:l(()=>[...a[25]||=[n(`保存设置`,-1)]]),_:1})]),_:1})]),_:1},8,[`model`])]),_:1})]),_:1}),s(x,{label:`关于`,name:`about`},{default:l(()=>[s(g,{class:`settings-card`},{default:l(()=>[t(`div`,T,[a[26]||=t(`h2`,null,`AI Terminal`,-1),a[27]||=t(`p`,{class:`version`},`版本：1.0.0`,-1),s($),a[28]||=t(`p`,null,`AI Terminal 是一个智能服务器管理终端，集成了AI助手功能，帮助您更高效地管理服务器。`,-1),a[29]||=t(`p`,null,`主要功能：`,-1),a[30]||=t(`ul`,null,[t(`li`,null,`多服务器连接管理`),t(`li`,null,`Web-based 终端界面`),t(`li`,null,`AI 智能助手`),t(`li`,null,`会话管理和日志记录`),t(`li`,null,`安全的认证系统`)],-1),s($),a[31]||=t(`p`,{class:`copyright`},`© 2026 AI Terminal. All rights reserved.`,-1)])]),_:1})]),_:1})]),_:1},8,[`modelValue`])])}}}),[[`__scopeId`,`data-v-906b1426`]]);export{E as default};