import{B as e,C as t,D as n,E as r,F as i,K as a,N as o,O as s,R as c,V as l,i as u,k as d,n as f}from"./index-md6nwtnd.js";import{t as p}from"./_plugin-vue_export-helper-CSBScHBl.js";import{t as m}from"./axios-BQg8eLdS.js";var h={class:`login-container`},g=p(d({__name:`LoginView`,setup(a){let d=f(),p=l(),g=l(!1),_=e({username:``,password:``,remember:!1}),v={username:[{required:!0,message:`请输入用户名`,trigger:`blur`}],password:[{required:!0,message:`请输入密码`,trigger:`blur`}]},y=async()=>{if(p.value)try{await p.value.validate(),g.value=!0;let e=new URLSearchParams;e.append(`username`,_.username),e.append(`password`,_.password);let{access_token:t,user:n}=(await m.post(`/api/auth/login`,e,{headers:{"Content-Type":`application/x-www-form-urlencoded`}})).data;localStorage.setItem(`access_token`,t),localStorage.setItem(`user_id`,n.id),localStorage.setItem(`user_role`,n.role),localStorage.setItem(`user_name`,n.username),_.remember&&localStorage.setItem(`remember_user`,_.username),u.success(`登录成功`),d.push(`/`)}catch(e){e.response?u.error(e.response.data.detail||`登录失败`):u.error(`网络错误，请稍后重试`)}finally{g.value=!1}};return(e,a)=>{let l=i(`el-input`),u=i(`el-form-item`),d=i(`el-checkbox`),f=i(`el-button`),m=i(`el-form`),b=i(`el-card`);return o(),r(`div`,h,[s(b,{class:`login-card`},{header:c(()=>[...a[3]||=[t(`div`,{class:`login-header`},[t(`h2`,null,`AI Terminal`),t(`p`,null,`智能服务器管理终端`)],-1)]]),default:c(()=>[s(m,{model:_,rules:v,ref_key:`loginFormRef`,ref:p,"label-width":`80px`},{default:c(()=>[s(u,{label:`用户名`,prop:`username`},{default:c(()=>[s(l,{modelValue:_.username,"onUpdate:modelValue":a[0]||=e=>_.username=e,placeholder:`请输入用户名`,"prefix-icon":`UserFilled`},null,8,[`modelValue`])]),_:1}),s(u,{label:`密码`,prop:`password`},{default:c(()=>[s(l,{modelValue:_.password,"onUpdate:modelValue":a[1]||=e=>_.password=e,type:`password`,placeholder:`请输入密码`,"prefix-icon":`Lock`,"show-password":``},null,8,[`modelValue`])]),_:1}),s(u,null,{default:c(()=>[s(d,{modelValue:_.remember,"onUpdate:modelValue":a[2]||=e=>_.remember=e},{default:c(()=>[...a[4]||=[n(`记住我`,-1)]]),_:1},8,[`modelValue`])]),_:1}),s(u,null,{default:c(()=>[s(f,{type:`primary`,onClick:y,loading:g.value,style:{width:`100%`}},{default:c(()=>[...a[5]||=[n(` 登录 `,-1)]]),_:1},8,[`loading`])]),_:1})]),_:1},8,[`model`])]),_:1})])}}}),[[`__scopeId`,`data-v-d6521361`]]);export{g as default};